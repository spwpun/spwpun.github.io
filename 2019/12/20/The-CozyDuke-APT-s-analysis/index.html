<!DOCTYPE html>





<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.1">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.1" color="#222">
  <link rel="manifest" href="/images/manifest.json">

<link rel="stylesheet" href="/css/main.css?v=7.4.1">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Times New Roman:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.1',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="PrefixThis article is copied from Kaspersky‘s site, which just for learning. It’s an analysis of the HEUR:Trojan.Win32.CozyDuke.gen and Trojan.Win32.CozyBear.*.">
<meta name="keywords" content="apt">
<meta property="og:type" content="article">
<meta property="og:title" content="The CozyDuke APT&#39;s analysis">
<meta property="og:url" content="https://spwpun.github.io/2019/12/20/The-CozyDuke-APT-s-analysis/index.html">
<meta property="og:site_name" content="Spwpun&#39;s Blog">
<meta property="og:description" content="PrefixThis article is copied from Kaspersky‘s site, which just for learning. It’s an analysis of the HEUR:Trojan.Win32.CozyDuke.gen and Trojan.Win32.CozyBear.*.">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061845/monkeys.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061725/CozyDuke_map.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061738/collectedSystemInfo.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061840/FakeCerts.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061836/CDconfig.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061832/db.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061810/decodedConfig.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061756/victimTask.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061752/victimOneDrive.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061748/victimDecode.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061742/victimErrors.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061828/cachetable.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061824/CacheDLL_ADB_Setup.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061820/cryptedBlob.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061813/DecryptedBlob.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061805/onion.png">
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061800/exports.png">
<meta property="og:updated_time" content="2020-03-30T01:40:12.893Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="The CozyDuke APT&#39;s analysis">
<meta name="twitter:description" content="PrefixThis article is copied from Kaspersky‘s site, which just for learning. It’s an analysis of the HEUR:Trojan.Win32.CozyDuke.gen and Trojan.Win32.CozyBear.*.">
<meta name="twitter:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061845/monkeys.png">
  <link rel="canonical" href="https://spwpun.github.io/2019/12/20/The-CozyDuke-APT-s-analysis/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>The CozyDuke APT's analysis | Spwpun's Blog</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Spwpun's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="fa fa-search fa-fw"></i>Search</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/spwpun" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="https://spwpun.github.io/2019/12/20/The-CozyDuke-APT-s-analysis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Demen Lee">
      <meta itemprop="description" content="Sharing, Communicating more, then moving on......">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Spwpun's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">The CozyDuke APT's analysis

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2019-12-20 01:07:21" itemprop="dateCreated datePublished" datetime="2019-12-20T01:07:21+08:00">2019-12-20</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-30 09:40:12" itemprop="dateModified" datetime="2020-03-30T09:40:12+08:00">2020-03-30</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/样本分析/" itemprop="url" rel="index"><span itemprop="name">样本分析</span></a></span>

                
                
              
            </span>
          

          
            <span id="/2019/12/20/The-CozyDuke-APT-s-analysis/" class="post-meta-item leancloud_visitors" data-flag-title="The CozyDuke APT's analysis" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/12/20/The-CozyDuke-APT-s-analysis/#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2019/12/20/The-CozyDuke-APT-s-analysis/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="Prefix"><a href="#Prefix" class="headerlink" title="Prefix"></a>Prefix</h3><p>This article is copied from Kaspersky‘s <a href="https://securelist.com/the-cozyduke-apt/69731/" target="_blank" rel="noopener">site</a>, which just for learning. It’s an analysis of the <code>HEUR:Trojan.Win32.CozyDuke.gen</code> and <code>Trojan.Win32.CozyBear.*</code>.</p><a id="more"></a>
<h1 id="The-CozyDuke-APT"><a href="#The-CozyDuke-APT" class="headerlink" title="The CozyDuke APT"></a>The CozyDuke APT</h1><p>By <a href="https://securelist.com/author/kurtb/" target="_blank" rel="noopener">Kurt Baumgartner</a>, <a href="https://securelist.com/author/costin/" target="_blank" rel="noopener">Costin Raiu</a> on April 21, 2015. 8:50 pm</p>
<p>CozyDuke (aka CozyBear, CozyCar or “Office Monkeys”) is a precise attacker. Kaspersky Lab has observed signs of attacks against government organizations and commercial entities in the US, Germany, South Korea and Uzbekistan. In 2014, targets included the White House and the US Department of State, as believed.</p>
<p>The operation presents several interesting aspects</p>
<ul>
<li>extremely sensitive high profile victims and targets</li>
<li>evolving crypto and anti-detection capabilities</li>
<li>strong malware functional and structural similarities mating this toolset to early MiniDuke second stage components, along with more recent CosmicDuke and OnionDuke components</li>
</ul>
<p>The actor often spearphishes targets with e-mails containing a link to a hacked website. Sometimes it is a high profile, legitimate site such as “diplomacy.pl”, hosting a ZIP archive. The ZIP archive contains a RAR SFX which installs the malware and shows an empty PDF decoy.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061845/monkeys.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061845/monkeys.png" alt="monkeys"></a></p>
<p>In other highly successful runs, this actor sends out phony flash videos directly as email attachments. A clever example is “Office Monkeys LOL Video.zip”. The executable within not only plays a flash video, but drops and runs another CozyDuke executable. These videos are quickly passed around offices with delight while systems are infected in the background silently. Many of this APT’s components are signed with phony Intel and AMD digital certificates.</p>
<p>Recent CozyDuke APT activity attracted significant attention in the news:</p>
<p><a href="http://www.cnn.com/2015/03/10/politics/state-department-hack-worst-ever/" target="_blank" rel="noopener">Sources: State Dept. hack the ‘worst ever’</a>, CNN News, March 2015<br><a href="http://www.bbc.com/news/technology-29817644" target="_blank" rel="noopener">White House computer network ‘hacked’</a>, BBC News, October 2014<br><a href="http://www.wsj.com/articles/three-months-later-state-department-hasnt-rooted-out-hackers-1424391453" target="_blank" rel="noopener">Three Months Later, State Department Hasn’t Rooted Out Hackers</a>, Wall Street Journal, February 2015<br><a href="http://www.washingtonpost.com/world/national-security/state-department-shuts-down-its-e-mail-system-amid-concerns-about-hacking/2014/11/16/92cf0722-4815-41ca-b602-9bfe8ecdb256_story.html" target="_blank" rel="noopener">State Department shuts down its e-mail system amid concerns about hacking</a>, Washington Post, November 2014</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061725/CozyDuke_map.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061725/CozyDuke_map.png" alt="CozyDuke_map"></a></p>
<p>Let’s examine a smattering of representative CozyDuke files and data. There is much to their toolset.</p>
<h3 id="Office-Monkeys-dropper-analysis"><a href="#Office-Monkeys-dropper-analysis" class="headerlink" title="Office Monkeys dropper analysis"></a>Office Monkeys dropper analysis</h3><p>CozyDuke droppers and spyware components often maintain fairly common characteristics, but these files’ functionality are modified in slight ways depending on the team’s needs. This rapid development and deployment is interesting.</p>
<p>68271df868f462c06e24a896a9494225,<strong>Office Monkeys LOL Video.zip</strong></p>
<p>Believe it or not, recipients in bulk run the file within:</p>
<p>95b3ec0a4e539efaa1faa3d4e25d51de,<strong>Office Monkeys (Short Flash Movie).exe</strong></p>
<p>This file in turn drops two executables to %temp%:</p>
<ul>
<li>2aabd78ef11926d7b562fd0d91e68ad3, Monkeys.exe</li>
<li>3d3363598f87c78826c859077606e514, player.exe</li>
</ul>
<p>It first launches Monkeys.exe, playing a self-contained, very funny video of white-collar tie wearing chimpanzees working in a high rise office with a human colleague. It then launches player.exe, a CozyDuke dropper maintaining anti-detection techniques:</p>
<p>3d3363598f87c78826c859077606e514,player.exe,338kb,Trojan.Win32.CozyBear.v,CompiledOn:2014.07.02 21:13:33</p>
<h3 id="Anti-detection-and-trojan-functionality"><a href="#Anti-detection-and-trojan-functionality" class="headerlink" title="Anti-detection and trojan functionality"></a>Anti-detection and trojan functionality</h3><p>The file collects system information, and then invokes a WMI instance in the rootsecuritycenter namespace to identify security products installed on the system, meaning that this code was built for x86 systems, wql here:</p>
<p>SELECT * FROM AntiVirusProduct<br>SELECT * FROM FireWallProduct</p>
<p>The code hunts for several security products to evade:</p>
<ul>
<li>CRYSTAL</li>
<li>KASPERSKY</li>
<li>SOPHOS</li>
<li>DrWeb</li>
<li>AVIRA</li>
<li>COMODO Dragon</li>
</ul>
<p>In addition to the WMI/wql use, it also hunts through the “SOFTWAREMicrosoftWindowsCurrentVersionUninstall” registry key looking for security products to avoid. Following these checks, it drops several more malware files signed with the pasted AMD digital signature to a directory it creates. These files are stored within an 217kb encrypted cab file in the dropper’s resources under the name “A”. The cab file was encrypted and decrypted using a simple xor cipher with a rotating 16 byte key: x36x11xddx08xacx4bx72xf8x51x04x68x2ex3ex38x64x32.</p>
<p>The cab file is decompressed and its contents are created on disk. These dropped files bundle functionality for both 64bit and 32bit Windows systems and are all located within one directory:<br>C:\Documents and Settings\userApplication Data\ATI_Subsystem</p>
<p>6761106f816313394a653db5172dc487,amdhcp32.dll,54kb  ← 32bit dll,CompiledOn:2014.07.02 21:13:24<br>d596827d48a3ff836545b3a999f2c3e3,aticaldd.dll,60kb  ← 64bit dll,CompiledOn:2014.07.02 21:13:26<br>bc626c8f11ed753f33ad1c0fe848d898,atiumdag.dll,285kb ← 32bit dll, Trojan.Win32.CozyDuke.a, CompiledOn:2014.07.02 21:13:26<br>4152e79e3dbde55dcf3fc2014700a022,6kb,racss.dat</p>
<p>The code copies rundll32.exe from windows\system32 to its newly created %appdata%ATI_Subsystem subdirectory as “amdocl_as32.exe” alongside the three dll’s listed above. It runs atiumdag.dll with two parameter values, it’s only export and an arbitrary pid,  i.e.:<br>“C:\Documents and Settings\userApplication Data\ATI_Subsystem\amdocl_as32.exe” “C:Documents and SettingsuserApplication DataATI_Subsystematiumdag.dll””, ADL2_ApplicationProfiles_System_Reload 1684″</p>
<p>This dll is built with anti-AV protections as well. However, it looks for a different but overlapping set, and the random duplication suggests that this component was cobbled together with its dropper, partly regionally based on target selection.</p>
<ul>
<li>K7</li>
<li>KASPERSKY</li>
<li>AVG</li>
</ul>
<p>The code collects information about the system and xml formats this data prior to encryption for proper parsing:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061738/collectedSystemInfo.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061738/collectedSystemInfo.png" alt="collectedSystemInfo"></a></p>
<p>Finally, this process beacons to <code>www.sanjosemaristas[.]com</code>, which appears to be a site that has been compromised and misused multiple times in the past couple of years.<br>hxxp://<a href="http://www.sanjosemaristas[.]com/app/index.php?{A01BA0AD-9BB3-4F38-B76B-A00AD11CBAAA}" target="_blank" rel="noopener">www.sanjosemaristas[.]com/app/index.php?{A01BA0AD-9BB3-4F38-B76B-A00AD11CBAAA}</a>, providing the current network adapter’s service name GUID. It uses standard Win32 base cryptography functions to generate a CALG_RC4 session key to encrypt the collected data communications and POSTs it to the server.</p>
<h3 id="Executable-Signing-Certificates"><a href="#Executable-Signing-Certificates" class="headerlink" title="Executable-Signing Certificates"></a>Executable-Signing Certificates</h3><p>Samples are usually signed with a fake certificate – we’ve seen two instances, one AMD and one Intel:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061840/FakeCerts.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061840/FakeCerts.png" alt="FakeCerts"></a></p>
<h3 id="Configuration-files"><a href="#Configuration-files" class="headerlink" title="Configuration files:"></a>Configuration files:</h3><p>Some of the malware uses an encrypted configuration file which is stored on disk as “racss.dat”. This is encrypted by RC4, using the key {0xb5, 0x78, 0x62, 0x52, 0x98, 0x3e, 0x24, 0xd7, 0x3b, 0xc6, 0xee, 0x7c, 0xb9, 0xed, 0x91, 0x62}. Here’s how it looks decrypted:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061836/CDconfig.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061836/CDconfig.png" alt="CDconfig"></a></p>
<h3 id="Second-stage-malware-and-communications"><a href="#Second-stage-malware-and-communications" class="headerlink" title="Second stage malware and communications:"></a>Second stage malware and communications:</h3><p>The attackers send commands and new modules to be executed to the victims through the C&amp;Cs. The C&amp;C scripts store these temporarily until the victim next connects to retrieve local files. We’ve identified two such files:</p>
<ul>
<li>settings.db</li>
<li>sdfg3d.db</li>
</ul>
<p>Here’s how such a database file appears:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061832/db.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061832/db.png" alt="db"></a></p>
<p>These are BASE64 encoded and use the same RC4 encryption key as the malware configuration.</p>
<p>Decoding them resulted in the following payloads:</p>
<p>59704bc8bedef32709ab1128734aa846, ChromeUpdate.ex_<br>5d8835982d8bfc8b047eb47322436c8a, cmd_task.dll<br>e0b6f0d368c81a0fb197774d0072f759, screenshot_task.dll</p>
<p>Decoding them also resulted in a set of tasking files maintaining agent commands and parameter values:</p>
<p>conf.xml</p>
<p>And a set of “reporting” files, maintaining stolen system “info”, error output, and “AgentInfo” output, from victim systems:</p>
<p>DCOM_amdocl_ld_API_.raw<br>Util_amdave_System_.vol<br>Last_amdpcom_Subsystem_.max<br>Data_amdmiracast_API_.aaf<br>7.txt</p>
<p>screenshot_task.dll is a 32-bit dll used to take a screenshot of the full desktop window and save it as a bitmap in %temp%. The number of times the screenshot is repeated is configurable within the xml task file.</p>
<p>cmd_task.dll is a 32-bit dll that maintains several primitives. It is used to create new processes, perform as a command line shell, and several other tasks.</p>
<p>Each of these payloads is delivered together with a configuration file that explains how to run it, for instance:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061810/decodedConfig.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061810/decodedConfig.png" alt="decodedConfig"></a><br>In another tasking, we notice a tracked victim:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061756/victimTask.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061756/victimTask.png" alt="victimTask"></a></p>
<p>Attackers map a network drive use Microsoft OneDrive to run further tools:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061752/victimOneDrive.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061752/victimOneDrive.png" alt="victimOneDrive"></a></p>
<p>They copy down a base64 encoded document from Microsoft OneDrive to the victim system and decode it there:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061748/victimDecode.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061748/victimDecode.png" alt="victimDecode"></a></p>
<p>Not everything works as planned, so they maintain error reporting facility for the c2 communications:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061742/victimErrors.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061742/victimErrors.png" alt="victimErrors"></a></p>
<p>Furthermore, ChromeUpdate is a 64-bit executable (which appears to be a WEXTRACT package) that oddly drops a 32-bit Dll. Cache.dll is simply stored as a cabinet file in the ChromeUpdate’s resource section.</p>
<p>ChromeUpdate.exe starts the file with “rundll32 cache.dll,ADB_Setup”</p>
<h3 id="Cache-dll-analysis"><a href="#Cache-dll-analysis" class="headerlink" title="Cache.dll analysis"></a>Cache.dll analysis</h3><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061828/cachetable.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061828/cachetable.png" alt="cachetable"></a></p>
<p>Cache.dll was written in C/C++ and built with a Microsoft compiler.</p>
<p>Cache.dll code flow overview</p>
<ul>
<li>RC4 decrypt hardcoded c2 and urls</li>
<li>resolve hidden function calls</li>
<li>collect identifying victim system data</li>
<li>encrypt collected data</li>
<li>send stolen data to c2 and retrieve commands</li>
</ul>
<h3 id="Cache-dll-code-details"><a href="#Cache-dll-code-details" class="headerlink" title="Cache.dll code details"></a>Cache.dll code details</h3><p>Structurally, “Cache.dll” is a fairly large backdoor at 425KB. It maintains both code and data in the raw, encrypted blobs of data to be decrypted and used at runtime, and hidden functionality that isn’t exposed until runtime. No pdb/debug strings are present in the code.</p>
<p>It maintains eight exports, including DllMain:</p>
<ul>
<li>ADB_Add</li>
<li>ADB_Cleanup</li>
<li>ADB_Initnj</li>
<li>ADB_Load</li>
<li>ADB_Release</li>
<li>ADB_Remove</li>
<li>ADB_Setup</li>
</ul>
<p>ADB_Setup is a entry point that simply spawns another thread and waits for completion.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061824/CacheDLL_ADB_Setup.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061824/CacheDLL_ADB_Setup.png" alt="CacheDLL_ADB_Setup"></a></p>
<p>Above, we see a new thread created with the start address of Cache.dll export  “ADB_Load” by the initial thread.</p>
<p>This exported function is passed control while the initial thread runs a Windows message loop. It first grabs an encrypted blob stored away in a global variable and pulls out 381 bytes of this encrypted data:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061820/cryptedBlob.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061820/cryptedBlob.png" alt="cryptedBlob"></a></p>
<p>The standard win32 api CryptDecrypt uses rc4 to decrypt this blob into a hardcoded c2, url path, and url parameters listed below with a simple 140-bit key “x8BxFFx55x8BxECx83xECx50xA1x84x18x03x68x33xC9x66xF7x45x10xE8x1Fx89x45xFCx8Bx45x14x56”.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061813/DecryptedBlob.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061813/DecryptedBlob.png" alt="DecryptedBlob"></a></p>
<p>The code then decodes this set of import symbols and resolves addresses for its networking and data stealing functionality:</p>
<p>InternetCloseHandle<br>InternetReadFile<br>HttpSendRequestA<br>HttpOpenRequestA<br>HttpQueryInfoA<br>InternetConnectA<br>InternetCrackUrlA<br>InternetOpenA<br>InternetSetOptionW<br>GetAdaptersInfo</p>
<p>Much like the prior office monkey “atiumdag.dll” component, this code collects identifying system information using standard win32 API calls:</p>
<ul>
<li>Computer name – GetComputerNameW</li>
<li>User name – GetUserNameW</li>
<li>Adapter GUID, ip address, mac address – GetAdaptersInfo</li>
<li>Windows version – GetVersionExW</li>
</ul>
<p>It then uses the runtime resolved networking API calls to send the collected data back to a hardcoded c2 and set of urls.</p>
<p>Cache.dll connectback urls:</p>
<ul>
<li>209.200.83.43/ajax/links.php</li>
<li>209.200.83.43/ajax/api.php</li>
<li>209.200.83.43/ajax/index.php</li>
<li>209.200.83.43/ajax/error.php</li>
<li>209.200.83.43/ajax/profile.php</li>
<li>209.200.83.43/ajax/online.php</li>
<li>209.200.83.43/ajax/loader.php</li>
<li>209.200.83.43/ajax/search.php</li>
</ul>
<p>Observed user-agent string on the wire, but it’s dynamically generated based on the Windows system settings (retrieved using standard win32 api “ObtainUserAgentString”):<br>“User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)”</p>
<p>Communications with the CozyDuke C2 include key/value pairs passed as URL parameters. Observed keys that remind us of the Cosmicduke communications include:</p>
<ul>
<li>status=</li>
<li>k=</li>
<li>mode=</li>
<li>ajax=</li>
<li>name=</li>
<li>subNodeId=</li>
<li>nodeId=</li>
<li>r=</li>
<li>t=</li>
<li>id=</li>
<li>item=</li>
<li>item_id=</li>
<li>js=</li>
<li>j=</li>
<li>v=</li>
<li>json=</li>
<li>i=</li>
<li>c=</li>
<li>x=</li>
<li>a=</li>
</ul>
<h3 id="Connections-with-MiniDuke-CosmicDuke-OnionDuke"><a href="#Connections-with-MiniDuke-CosmicDuke-OnionDuke" class="headerlink" title="Connections with MiniDuke/CosmicDuke/OnionDuke:"></a>Connections with MiniDuke/CosmicDuke/OnionDuke:</h3><p>One of the second stage modules of CozyDuke/Cozy Bear, Show.dll, is particularly interesting because it appears to have been built onto the same platform as OnionDuke. Below we compare Show.dll with the OnionDuke sample MD5: c8eb6040fd02d77660d19057a38ff769. Both have exactly the same export tables and appear to be called internally “UserCache.dll”:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061805/onion.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061805/onion.png" alt="onion"></a></p>
<p>This seems to indicate the authors of OnionDuke and CozyDuke / Cozy Bear are the same, or working together.</p>
<p>Another interesting comparison of two other files matches a recent second stage tool from the CozyDuke attacks with a second stage component from other Miniduke/Onionduke attacks.</p>
<p>2e0361fd73f60c76c69806205307ccac, update.dll (MiniDuke), 425kb (internal name = “<strong>UserCache.dll</strong>“)<br>9e3f3b5e9ece79102d257e8cf982e09e, cache.dll (CozyDuke), 425kb (internal name = “<strong>UserCache.dll</strong>“)</p>
<p>The two share identical export function names in their export directories, and the naming appears to be randomly assigned at compile time. The table below presents the function matches based on size data, but the calls, jmps and code all match as well. The contents of only one of these exports in update.dll has no match whatsoever in cache.dll.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061800/exports.png" target="_blank" rel="noopener"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/08061800/exports.png" alt="exports"></a></p>
<p>Unlike the atiumdag.dll file above, however, cache.dll and update.dll do not maintain anti-AV and anti-analysis functionality sets. Perhaps they plan to pair this stealer with another dropper that maintains the WMI anti-AV functionality. This rotating functionality seems representational for the set, along with other characteristics. Their custom backdoor components appear to slightly evolve over time, with modifications to anti-detection, cryptography, and trojan functionality changing per operation. This rapid development and deployment reminds us of the APT28/Sofacy toolset, especially the coreshell and chopstick components.</p>
<p>We expect ongoing and further activity from this group in the near future and variations on the malware used in previous duke-ish incidents.</p>
<p>For more information about MiniDuke, CosmicDuke and OnionDuke, please see References.</p>
<h3 id="Related-MD5s"><a href="#Related-MD5s" class="headerlink" title="Related MD5s"></a>Related MD5s</h3><p>62c4ce93050e48d623569c7dcc4d0278, 2537.ex_<br>a5d6ad8ad82c266fda96e076335a5080, drop1.ex_<br>93176df76e351b3ea829e0e6c6832bdf, drop1.pd_<br>7688be226b946e231e0cd36e6b708d20, 8.zip<br>fd8e27f820bdbdf6cb80a46c67fd978a, doc853.ex_<br>93176df76e351b3ea829e0e6c6832bdf, doc853.pdf<br>9ad55b83f2eec0c19873a770b0c86a2f, reader_sl.ex_<br>f16dff8ec8702518471f637eb5313ab2 1.ex_<br>8670710bc9477431a01a576b6b5c1b2a<br>93176df76e351b3ea829e0e6c6832bdf, droppedhppscan854.pdf<br>f58a4369b8176edbde4396dc977c9008, droppedreader_sl.ex_<br>83f57f0116a3b3d69ef7b1dbe9943801<br>b5553645fe819a93aafe2894da13dae7<br>acffb2823fc655637657dcbd25f35af8<br>1a42acbdb285a7fba17f95068822ea4e<br>d543904651b180fd5e4dc1584e639b5e<br>d7af9a4010c75af6756a603fd6aef5a4<br>93176df76e351b3ea829e0e6c6832bdf, 3852.pdf<br>f2b05e6b01be3b6cb14e9068e7a66fc1, droppedreader_sl.ex_<br>57a1f0658712ee7b3a724b6d07e97259, dropped3852.ex_<br>93176df76e351b3ea829e0e6c6832bdf, 5463.pdf<br>eb22b99d44223866e24872d80a4ddefd, dropped5463reader_sl.ex_<br>90bd910ee161b71c7a37ac642f910059, dropped5463.ex_<br>1a262a7bfecd981d7874633f41ea5de8<br>98a6484533fa12a9ba6b1bd9df1899dc<br>7f6bca4f08c63e597bed969f5b729c56<br>08709ef0e3d467ce843af4deb77d74d5</p>
<h3 id="Related-CozyDuke-C-amp-Cs"><a href="#Related-CozyDuke-C-amp-Cs" class="headerlink" title="Related CozyDuke C&amp;Cs:"></a>Related CozyDuke C&amp;Cs:</h3><table>
<thead>
<tr>
<th>1234567891011121314151617181920212223</th>
<th>121.193.130.170:443/wp-ajax.php183.78.169.5:443/search.php200.119.128.45:443/mobile.php200.125.133.28:443/search.php200.125.142.11:443/news.php201.76.51.10:443/plugins/json.php202.206.232.20:443/rss.php202.76.237.216:443/search.php203.156.161.49:443/plugins/twitter.php208.75.241.246:443/msearch.php209.40.72.2:443/plugins/fsearch.php210.59.2.20:443/search.php208.77.177.24:443/fsearch.php<a href="http://www.getiton.hants.org.uk:80/themes/front/img/ajax.phpwww.seccionpolitica.com.ar:80/galeria/index.php209.200.83.43/ajax/links.php209.200.83.43/ajax/api.php209.200.83.43/ajax/index.php209.200.83.43/ajax/error.php209.200.83.43/ajax/profile.php209.200.83.43/ajax/online.php209.200.83.43/ajax/loader.php209.200.83.43/ajax/search.php" target="_blank" rel="noopener">www.getiton.hants.org.uk:80/themes/front/img/ajax.phpwww.seccionpolitica.com.ar:80/galeria/index.php209.200.83.43/ajax/links.php209.200.83.43/ajax/api.php209.200.83.43/ajax/index.php209.200.83.43/ajax/error.php209.200.83.43/ajax/profile.php209.200.83.43/ajax/online.php209.200.83.43/ajax/loader.php209.200.83.43/ajax/search.php</a></th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="Appendix-Parallel-and-Previous-Research"><a href="#Appendix-Parallel-and-Previous-Research" class="headerlink" title="Appendix: Parallel and Previous Research"></a>Appendix: Parallel and Previous Research</h3><p><a href="http://securelist.com/blog/31112/the-miniduke-mystery-pdf-0-day-government-spy-assembler-0x29a-micro-backdoor/" target="_blank" rel="noopener">The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor</a>, Securelist, Feb 2013<br><a href="https://securelist.com/blog/64107/miniduke-is-back-nemesis-gemina-and-the-botgen-studio/" target="_blank" rel="noopener">Miniduke is back: Nemesis Gemina and the Botgen Studio</a>, Securelist, July 2014<br><a href="http://blog.crysys.hu/2014/07/miniduke-2-cosmicduke/" target="_blank" rel="noopener">MiniDuke 2 (CosmicDuke)</a>, CrySyS, July 2014<br><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/04/20081948/cosmicduke_whitepaper.pdf" target="_blank" rel="noopener">COSMICDUKE Cosmu with a twist of MiniDuke [pdf]</a>, F-Secure, September 2014<br><a href="http://www.leviathansecurity.com/blog/the-case-of-the-modified-binaries/" target="_blank" rel="noopener">THE CASE OF THE MODIFIED BINARIES</a>, Leviathan Security, October 2014<br><a href="http://bartblaze.blogspot.com/2014/09/a-word-on-cosmicduke.html" target="_blank" rel="noopener">A word on CosmicDuke</a>, Blaze’s Security Blog, September 2014<br><a href="https://www.f-secure.com/weblog/archives/00002764.html" target="_blank" rel="noopener">OnionDuke: APT Attacks Via the Tor Network</a>, F-Secure, November 2014<br><a href="https://www.f-secure.com/weblog/archives/00002780.html" target="_blank" rel="noopener">The Connections Between MiniDuke, CosmicDuke and OnionDuke</a>, F-Secure, January 2015</p>
<p>Kaspersky Lab products detect the malware used by the CozyDuke threat actor as:<br>HEUR:Trojan.Win32.CozyDuke.gen<br>Trojan.Win32.CozyBear.*</p>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/apt/" rel="tag"># apt</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/12/16/apt29样本分析记录/" rel="next" title="apt29样本分析记录">
                  <i class="fa fa-chevron-left"></i> apt29样本分析记录
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/12/28/pwn_tips/" rel="prev" title="pwn tips in gdb">
                  pwn tips in gdb <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    
    <div class="comments" id="comments"></div>
  

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Prefix"><span class="nav-text">Prefix</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-CozyDuke-APT"><span class="nav-text">The CozyDuke APT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Office-Monkeys-dropper-analysis"><span class="nav-text">Office Monkeys dropper analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Anti-detection-and-trojan-functionality"><span class="nav-text">Anti-detection and trojan functionality</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Executable-Signing-Certificates"><span class="nav-text">Executable-Signing Certificates</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configuration-files"><span class="nav-text">Configuration files:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Second-stage-malware-and-communications"><span class="nav-text">Second stage malware and communications:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cache-dll-analysis"><span class="nav-text">Cache.dll analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cache-dll-code-details"><span class="nav-text">Cache.dll code details</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Connections-with-MiniDuke-CosmicDuke-OnionDuke"><span class="nav-text">Connections with MiniDuke/CosmicDuke/OnionDuke:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Related-MD5s"><span class="nav-text">Related MD5s</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Related-CozyDuke-C-amp-Cs"><span class="nav-text">Related CozyDuke C&amp;Cs:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Appendix-Parallel-and-Previous-Research"><span class="nav-text">Appendix: Parallel and Previous Research</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/avatar.gif"
      alt="Demen Lee">
  <p class="site-author-name" itemprop="name">Demen Lee</p>
  <div class="site-description" itemprop="description">Sharing, Communicating more, then moving on......</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">tags</span>
        </a>
      </div>
    
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/spwpun" title="GitHub &rarr; https://github.com/spwpun" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="mailto:spwpun@gmail.com" title="E-Mail &rarr; mailto:spwpun@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://weibo.com/u/5536839794" title="Weibo &rarr; https://weibo.com/u/5536839794" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://music.163.com/#/user/home?id=127070793" title="Netease &rarr; https://music.163.com/#/user/home?id=127070793" rel="noopener" target="_blank"><i class="fa fa-fw fa-netease"></i>Netease</a>
      </span>
    
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://whale3070.github.io" title="https://whale3070.github.io" rel="noopener" target="_blank">Whale3070</a>
        </li>
      
        <li class="links-of-blogroll-item">
          <a href="https://eternalhikari.github.io" title="https://eternalhikari.github.io" rel="noopener" target="_blank">Hikari</a>
        </li>
      
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-flag-checkered"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Spwpun</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a></div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a></div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
  
    <span class="post-meta-divider">|</span>
  
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
  
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.1"></script><script src="/js/motion.js?v=7.4.1"></script>
<script src="/js/schemes/pisces.js?v=7.4.1"></script>

<script src="/js/next-boot.js?v=7.4.1"></script>



  








  <script src="/js/local-search.js?v=7.4.1"></script>














  

  

  


<script>
NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: true,
    notify: false,
    appId: 'O9n8UnYXJ5M4s4QEumwRCwH9-gzGzoHsz',
    appKey: 'qdSjFo9LUO20Ba6XRPMQGX7v',
    placeholder: 'Leave something interesting......',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: true,
    lang: '' || 'zh-cn',
    path: location.pathname,
    recordIP: false,
    serverURLs: ''
  });
}, window.Valine);
</script>

</body>
</html>
